#!/usr/bin/env bash

project_dir=$(cd "$(dirname "$0")" && cd .. && pwd)

# will let the permissions be 0777
umask 000

if [[ -z $ENV || $ENV = 'dev' ]]; then
    composer --working-dir="$project_dir" install --no-ansi --no-interaction --no-progress
    npm install --prefix "$project_dir/app/Resources"
else
    composer --working-dir="$project_dir" install --no-ansi --no-interaction --no-progress --no-dev --optimize-autoloader
    npm install --prefix "$project_dir/app/Resources"
    "$project_dir/bin/console" assetic:dump
fi
