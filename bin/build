#!/usr/bin/env bash

if [ $# -eq 0 ]; then
    echo "Usage : build <project_dir>"
    exit
fi

if [ -z "$1" ] || [ ! -d "$1" ]; then
    echo '"project_dir" not found'
    exit
fi

project_dir=$1

cd $project_dir
setfacl -R -m u:www-data:rwX -m u:`whoami`:rwX app/cache app/logs
setfacl -dR -m u:www-data:rwX -m u:`whoami`:rwX app/cache app/logs
composer install
npm install --prefix app/Resources
cd -
