#!/usr/bin/env bash

ip=$(docker inspect --format='{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}' bagheera_nginx)
if [[ -z $ip ]]; then
    echo 'IP not found!'
    exit 1
fi

while [[ $(curl -Lso /dev/null -w '%{response_code}' "http://$ip") != 200 ]]; do
    echo "Waiting for nginx startup on http://$ip"
    sleep 2
done

if [[ $(uname -s) = 'Darwin' ]]; then
    alias 'xdg-open'='open'
fi

xdg-open "http://$ip"
